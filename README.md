# Honeypot Matrix - Real-time Cybersecurity Threat Intelligence System

This is a portfolio project showcasing a distributed honeypot system that monitors, analyzes, and visualizes cyber attacks in real-time. The system demonstrates a two-server architecture with a Raspberry Pi running DietPi as the honeypot host and a separate web server for data visualization and analysis.

## Overview

The Honeypot Matrix demonstrates advanced cybersecurity concepts through a distributed architecture designed to capture and analyze malicious network traffic. The system showcases Dionaea honeypot integration, incremental log processing algorithms, and real-time threat visualization techniques.

The application demonstrates the following data processing pipeline:
- Dionaea honeypot captures network attacks on the Raspberry Pi
- Python processor analyzes logs with incremental processing and persistent storage
- Data is transferred via SSH to the web server using automated scripts
- Interactive dashboard provides real-time attack visualization and analysis

> [!NOTE]  
> This project demonstrates production-ready incremental processing techniques to handle continuous data streams without performance degradation.

## Architecture

### Two-Server Infrastructure

**Honeypot Server (Raspberry Pi 3B with DietPi):**
- Runs Dionaea honeypot to capture attacks
- Processes logs using Python scripts
- Generates JSON data files
- Transfers data to web server via SSH
- Operates efficiently on 1GB RAM with optimized resource usage

**Web Server:**
- Receives processed data files
- Hosts interactive web dashboard
- Provides real-time attack visualization
- Serves threat intelligence data

### Data Flow

```
[Attackers] -> [Dionaea Honeypot] -> [Log Processor] -> [SSH Transfer] -> [Web Dashboard]
     |              |                      |               |              |
  Network         Raspberry Pi         Python Script    Data Transfer   Web Server
  Traffic         (DietPi)            (process_dionaea.py)  (rsync)     (HTML/JS)
```

## Features

- **Real-time Attack Monitoring**: Live attack detection and visualization with geographic mapping
- **Binary/Malware Analysis**: Comprehensive analysis of captured malware samples from both file system and log events
- **Advanced File Type Detection**: Binary header analysis with support for 20+ file types including executables, archives, documents, and scripts
- **Incremental Processing**: Hash-based deduplication with persistent storage across log rotations
- **Automated Backups**: Hourly timestamped backups with structured storage (year/month/day) uploaded to remote server
- **Interactive Dashboard**: Real-time web interface with 8 statistical cards including malware metrics
- **Geographic Intelligence**: Country-level attack mapping with GeoIP2 integration
- **Service Classification**: Automatic service detection and attack categorization
- **Mobile Optimization**: Responsive design with touch controls and adaptive layouts
- **Performance Optimization**: Efficient processing of 50K+ log lines with automatic cleanup
- **System Reset Tools**: Complete log clearing and reset capabilities for fresh starts

## Requirements

### Honeypot Server (Raspberry Pi)
- Raspberry Pi 3B (1GB RAM) - demonstrates efficient resource utilization
- DietPi operating system
- Python 3.6 or higher
- Dionaea honeypot software
- SSH client and rsync
- GeoIP2 database (optional)

### Web Server
- Web server (Apache/Nginx)
- Modern web browser with JavaScript support
- SSH server for data reception

> [!WARNING]  
> The honeypot server will attract real malicious traffic. Ensure proper network isolation and security measures are in place.

> [!IMPORTANT]  
> Both servers require proper SSH key authentication for automated data transfer.

## Project Structure

This portfolio project demonstrates a distributed system with code organized across two servers:

### Honeypot Server (Raspberry Pi with DietPi)
```
honeypot-server/
│
├── process_dionaea.py           # Enhanced log processor with binary analysis
├── upload_honey_data.sh         # Automated processing and backup system
├── clear_honeypot_logs.sh       # System reset and cleanup tool
├── honeypot-processor.service   # Systemd service configuration
│
├── dionaea.cfg                  # Dionaea honeypot configuration
├── dionaea.log                  # Live attack logs (generated by Dionaea)
│
├── binaries/                    # Captured malware samples directory
│   └── [various malware files] # Binary files captured from attacks
│
└── data/                        # Generated data files
    ├── persistent_attacks.json      # Long-term attack storage database
    ├── persistent_attacks_backup.json  # Backup attack database
    ├── processed_dionaea.log         # Processing position tracker
    ├── processed_hashes.txt          # Hash-based deduplication cache
    └── backups/                      # Automated backup storage
        └── YYYY/MM/DD/               # Date-organized backup hierarchy
            └── [timestamped-backups] # Hourly backup files
```

### Web Server
```
web-server/
│
├── index.html                   # Interactive dashboard with 8 statistics cards
├── style.css                    # Matrix-themed styling with malware visualizations
├── script.js                    # Enhanced data visualization with binary charts
│
└── data/                        # Received data files (via SSH transfer)
    ├── attacks.json                  # Recent attack data with binary analysis
    ├── daily_stats.json              # Daily aggregated statistics
    ├── hourly_stats.json             # Hourly trend data
    ├── summary.json                   # Overview statistics including malware metrics
    └── backups/                       # Synchronized backup files
        └── YYYY/MM/DD/                # Date-organized backup hierarchy
```
    ├── summary.json                  # Aggregated attack statistics
    ├── hourly_stats.json             # Time-based attack distribution
    └── daily_stats.json              # Daily attack patterns
```

### Key Technical Components

**Enhanced Log Processing Engine (process_dionaea.py):**
- Dual-source binary analysis from both file system and log events
- Advanced file type detection using binary headers (20+ formats)
- Hash-based deduplication using MD5 checksums with persistent storage
- UTF-8 safe processing with comprehensive error handling
- Maintains file position tracking for resumable processing across rotations
- Processes 50,000+ log lines while maintaining optimal performance

**Automated Backup System (upload_honey_data.sh):**
- Continuous processing with 15-second intervals
- Hourly timestamped backups with date hierarchy (year/month/day)
- Efficient rsync-based transfer with error handling and recovery
- Remote server synchronization with backup organization
- Service management and dependency checking

**Interactive Dashboard with Binary Analysis (Web Interface):**
- 8 comprehensive statistics cards including malware metrics
- Real-time attack visualization with geographic and binary mapping
- Chart.js integration for countries and malware type analysis
- Matrix-themed responsive design with mobile optimization
- Enhanced binary statistics display with file type breakdown

**System Reset and Maintenance Tools:**
- Complete log clearing functionality (clear_honeypot_logs.sh)
- Binary folder cleanup for fresh starts
- Comprehensive system reset capabilities

## Technical Demonstration

This project showcases several advanced cybersecurity and software engineering concepts:

### System Architecture
- Distributed processing across isolated network segments
- Automated data pipeline with error handling and recovery
- Service-oriented architecture with systemd integration
- SSH-based secure data transfer between servers

### Honeypot Server Configuration

The Raspberry Pi demonstrates production honeypot deployment with comprehensive analysis:
```bash
# Continuous processing service with binary analysis
./upload_honey_data.sh continuous

# Manual processing with binary analysis for demonstration
python3 process_dionaea.py --verbose --output-dir /tmp/honeypot_data

# System reset for fresh start
./clear_honeypot_logs.sh

# View captured malware samples
ls -la binaries/
```

### Web Dashboard Features

The enhanced interactive dashboard demonstrates modern web development with cybersecurity focus:

- **8 Comprehensive Statistics Cards**: Including total attacks, unique countries, binary captures, and malware analysis
- **Real-time Binary Analysis**: Live malware type detection and file format analysis
- **Geographic Attack Mapping**: Animated SVG visualization with country-based attack distribution
- **Malware Statistics Visualization**: Chart.js integration for binary type analysis with color-coded charts
- **Service-based Attack Analysis**: Protocol and service identification with trend analysis
- **Timeline Charts**: Attack pattern visualization over hourly and daily periods
- **Responsive Design**: Mobile-optimized interface with touch controls and adaptive layouts
- **Matrix Theme**: Cybersecurity-inspired visual design with animations

> [!NOTE]
> The dashboard provides real-time updates including binary analysis as malware samples are captured and processed.

## Implementation Details

### Enhanced Binary Analysis System

The system implements comprehensive malware analysis capabilities:

1. **Dual-Source Analysis**: Processes both physical binary files and log-based download events
2. **Advanced File Type Detection**: Binary header analysis supporting 20+ file formats including PE/ELF executables
3. **MD5 Hash Generation**: Unique identification for malware samples with deduplication
4. **File Format Recognition**: Automatic detection of executables, archives, documents, and scripts

### Incremental Log Processing

Sophisticated incremental processing handles continuous log streams:

1. **Position Tracking**: Maintains file position to resume processing after restarts
2. **Hash-based Deduplication**: Uses MD5 hashes to prevent reprocessing identical log lines
3. **Log Rotation Detection**: Automatically detects when Dionaea rotates log files
4. **Persistent Storage**: Maintains attack database independent of log file lifecycle

### Performance Optimization

- **Line Limit Management**: Automatically truncates logs when they exceed 50,000 lines
- **File Size Monitoring**: Triggers cleanup when log files exceed 5MB
- **Memory Efficient Processing**: Processes logs line-by-line without loading entire files
- **UTF-8 Safe Operations**: Comprehensive encoding handling preventing processing errors
- **Batch Data Transfer**: Uses rsync for efficient incremental uploads with automated backups

### Automated Backup System

- **Hourly Backups**: Timestamped backup creation every hour during processing
- **Date Hierarchy**: Organized backup storage by year/month/day structure
- **Remote Synchronization**: Automatic upload to remote server for redundancy
- **System Reset Tools**: Complete cleanup capabilities for fresh deployments

### Key Components

#### process_dionaea.py
- **Purpose**: Enhanced log processor with dual-source binary analysis and incremental updates
- **Key Features**: Binary analysis, file type detection, hash deduplication, UTF-8 handling, persistent storage
- **Binary Analysis**: Supports 20+ file formats including PE/ELF executables, archives, documents
- **Performance**: Processes 50,000+ log lines with binary analysis while maintaining sub-second response times

#### upload_honey_data.sh  
- **Purpose**: Continuous automation script with backup system and data transfer
- **Interval**: Processes logs every 15 seconds with hourly backup creation
- **Features**: Automated backups, dependency checking, error handling, logging, remote synchronization

#### clear_honeypot_logs.sh
- **Purpose**: System reset tool for complete cleanup and fresh starts
- **Features**: Log clearing, binary folder cleanup, data reset, comprehensive system restoration

#### Web Dashboard
- **Technology**: Enhanced JavaScript with Chart.js for binary and geographic visualizations
- **Features**: 8 statistics cards, binary analysis charts, real-time updates, interactive maps, responsive design
- **Binary Visualization**: Malware type charts matching country chart styling with dynamic color generation
- **Performance**: Optimized for mobile devices with touch controls and adaptive layouts

### Data Structures

The system generates comprehensive JSON data files with enhanced binary analysis:

- **attacks.json**: Recent attack entries with full details including binary analysis and file type detection
- **summary.json**: Aggregated statistics including malware metrics, file type distribution, and binary capture counts
- **hourly_stats.json**: Time-based attack distribution with binary download tracking
- **daily_stats.json**: Daily attack patterns including malware capture statistics
- **persistent_attacks.json**: Long-term attack storage with binary analysis surviving log rotations and system resets

### Backup Data Structure

- **Automated Backups**: Date-organized hierarchy (YYYY/MM/DD/) with hourly timestamped files
- **Remote Synchronization**: Backup files uploaded to remote server for redundancy
- **System Reset**: Clear logs tool removes all data for fresh deployments

> [!NOTE]  
> The persistent attack database ensures no data loss during Dionaea restarts or log rotations.

## Configuration

### Key Configuration Parameters

```bash
# upload_honey_data.sh
REMOTE_USER="username"
REMOTE_HOST="webserver.com"
REMOTE_PATH="/path/to/web/data/"
PROCESS_INTERVAL=15  # seconds
```

```python
# process_dionaea.py
log_path='/opt/dionaea/var/log/dionaea/dionaea.log'
output_dir='/tmp/honeypot_data'
max_log_lines=50000  # Keep last 50K lines
max_file_size=5000000  # 5MB limit
```

## Security Considerations

> [!CAUTION]
> This system will attract real malicious traffic. Implement proper security measures:

- Network isolation for the honeypot server
- Regular security updates for both servers
- Proper SSH key management
- Firewall rules restricting unnecessary access
- Regular backup of attack data

> [!WARNING]  
> Never expose the honeypot server directly to the internet without proper isolation.

## Performance Considerations

- **Hardware Efficiency**: Runs seamlessly on Raspberry Pi 3B with only 1GB RAM, demonstrating optimized resource management
- **Log Processing**: Handles 1000+ attacks per minute without performance degradation
- **Memory Usage**: Maintains constant memory footprint through incremental processing and intelligent caching
- **Storage**: Automatically manages log file sizes to prevent disk space issues
- **Network**: Efficient rsync transfers minimize bandwidth usage
- **Resource Optimization**: Line-by-line processing ensures minimal RAM consumption even on constrained hardware

## Monitoring and Maintenance

### System Health Checks

The enhanced dashboard provides comprehensive real-time status indicators:
- Honeypot connectivity status with binary analysis monitoring
- Last data update timestamp including malware capture time
- Processing queue status with binary analysis progress
- Attack frequency monitoring with file type distribution
- Malware capture statistics and binary analysis metrics

### Log and Binary Management

- Automatic log rotation handling with persistent binary tracking
- Configurable line limits (50,000 lines) for optimal performance
- Automated backup and recovery mechanisms with date hierarchy
- Hash-based duplicate prevention for both attacks and binary samples
- Binary folder management with automatic file type detection
- System reset capabilities for complete cleanup and fresh starts

> [!TIP]
> Monitor both the persistent attack database and binary folder sizes. Use the clear_honeypot_logs.sh script for complete system reset when needed.

## Troubleshooting

### Common Issues

1. **No Data Updates**: Check SSH connectivity and permissions
2. **High Memory Usage**: Reduce max_log_lines parameter
3. **Missing Attacks**: Verify Dionaea is running and logging properly
4. **Dashboard Not Loading**: Check web server configuration and file permissions
5. **Binary Analysis Issues**: Ensure binary folder permissions and UTF-8 encoding support
6. **Backup Failures**: Verify SSH connectivity and remote server disk space

### Debug Mode and System Reset

Enable verbose logging for troubleshooting:
```bash
# Verbose processing mode
python3 process_dionaea.py --verbose

# Complete system reset
./clear_honeypot_logs.sh

# Manual binary analysis check
ls -la binaries/ && python3 -c "import process_dionaea; process_dionaea.analyze_binary_folder('./binaries')"
```

> [!NOTE]  
> Verbose mode provides detailed information about processing steps, binary analysis, and potential issues. Use system reset for clean deployments.

## Build System

This portfolio project demonstrates comprehensive production automation practices:

- **Systemd Service Integration**: Daemon management for continuous processing
- **Automated Data Processing**: Error recovery with binary analysis capabilities  
- **Efficient File Synchronization**: Incremental rsync with automated backup system
- **Binary Analysis Pipeline**: Dual-source malware analysis from files and logs
- **Backup Automation**: Hourly timestamped backups with date hierarchy organization
- **System Reset Tools**: Complete cleanup capabilities for fresh deployments

## Known Limitations

> [!WARNING]  
> The system assumes specific Dionaea log formats. Changes to Dionaea configuration may require log parsing updates.

> [!IMPORTANT]
> - SSH key authentication must be properly configured for data transfer and backups
> - GeoIP database requires periodic updates for accurate geographic analysis
> - Large attack volumes and binary captures may require storage management
> - Binary analysis requires adequate disk space for malware sample storage
> - UTF-8 encoding support needed for international attack data processing

## Future Improvements

- Enhanced machine learning attack classification
- Advanced threat intelligence integration
- Automated response capabilities
- Extended retention policies
- API endpoints for external integration

## License and Disclaimer

> [!CAUTION]
> This software is for educational and research purposes. Users are responsible for complying with local laws and regulations regarding honeypot deployment.

> [!NOTE]  
> This project is designed for cybersecurity research and should only be deployed in controlled environments with proper authorization.

## Portfolio Highlights

This project demonstrates proficiency in:

**Backend Development:**
- Python log processing with advanced algorithms
- Incremental data processing and performance optimization
- Hash-based deduplication and caching mechanisms
- File I/O optimization and memory management

**System Administration:**
- Linux system configuration and service management
- SSH automation and secure data transfer
- Network security and isolation techniques
- Process monitoring and error handling
- Resource-efficient system design for embedded hardware (Raspberry Pi 3B/1GB RAM)

**Frontend Development:**
- Vanilla JavaScript with real-time data visualization
- Responsive web design with mobile optimization
- Chart.js integration for statistical displays
- Interactive geographic mapping with SVG manipulation

**DevOps Practices:**
- Automated deployment and service management
- Continuous data processing pipelines
- Error logging and system monitoring
- Cross-server automation and orchestration

> [!NOTE]  
> This project showcases real-world cybersecurity infrastructure and demonstrates enterprise-level system design principles.
